
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Kamranicus</title>
  <meta name="author" content="Kamran">

  
  <meta name="description" content="&ldquo;Programming is difficult business. It should never be undertaken in ignorance.&rdquo; &ndash; Javascript: The Good Parts, Douglas Crockford &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://kamranicus.com/blog/page/6">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="http://feeds.feedburner.com/Kamranicus" rel="alternate" title="Kamranicus" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href='http://fonts.googleapis.com/css?family=Droid+Sans' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Kreon' rel='stylesheet' type='text/css'>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-1203259-13']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Kamranicus</a></h1>
  
    <h2>Kamran Ayub is a developer and designer in Minneapolis, Minnesota. He specializes in .NET development with a dash of client-side and is passionate about UX.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss email">
  <li><a href="http://feeds.feedburner.com/Kamranicus" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
    <li><a href="http://feedburner.google.com/fb/a/mailverify?uri=Kamranicus" rel="subscribe-email" title="subscribe via email">Email</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:kamranicus.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/posts/29/programming-is-difficult-business-it-should-never">Programming Is Difficult Business. It Should Never Be Undertaken in Ignorance.</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-01-23T15:44:30-06:00" pubdate data-updated="true">Jan 23<span>rd</span>, 2012</time>
        
           | <a href="/blog/posts/29/programming-is-difficult-business-it-should-never#disqus_thread"
             data-disqus-identifier="http://kamranicus.com/blog/posts/29/programming-is-difficult-business-it-should-never">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><blockquote><p>&ldquo;Programming is difficult business. It should never be undertaken in ignorance.&rdquo; &ndash; <em>Javascript: The Good Parts</em>, Douglas Crockford</p></blockquote>

<p>What a great quote to program by.</p>

<p>I&rsquo;ve been undertaking a pet project (a <em>game</em>, no less) that&rsquo;s forced me to brush up on my Javascriptings. I would highly recommend this book if you also want to get your hands dirty with Javascript.</p>

<p>Oh, my game? Yah, I can&rsquo;t talk about it yet. I&rsquo;ve never made a game before (but I&rsquo;ve always wanted to) and I think I&rsquo;ve finally come up with something I could possibly do (i.e. not 3D, not requiring 25 art designers, and not in a language I don&rsquo;t know). We&rsquo;ll see how it goes and I&rsquo;ll let you know.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/posts/28/i-just-transferred-all-my-domains-away-from-my-god">I Just Transferred All My Domains Away From My GoDaddy Reseller Because of SOPA</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-12-23T19:12:45-06:00" pubdate data-updated="true">Dec 23<span>rd</span>, 2011</time>
        
           | <a href="/blog/posts/28/i-just-transferred-all-my-domains-away-from-my-god#disqus_thread"
             data-disqus-identifier="http://kamranicus.com/blog/posts/28/i-just-transferred-all-my-domains-away-from-my-god">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Since I started hosting my own domains and doing web work, I&rsquo;ve been using a website aptly named <a href="http://cheap-domainregistration.com">Cheap-DomainRegistration.com</a>. I also read today that <a href="http://www.reddit.com/r/politics/comments/nntxp/godaddys_response_to_the_boycott_go_daddy_has/">GoDaddy supports SOPA</a>. This is a Bad Thing<sup>TM</sup>. The proposed <a href="http://americancensorship.org/">SOPA legislation is bad</a>, just like drinking anti-freeze is bad for dogs.</p>

<blockquote><p>&ldquo;Hah!&rdquo; I said to myself, grinning in self-assuredness, &ldquo;I am not using GoDaddy. This does not pertain to me.&rdquo;</p></blockquote>

<p>There was a linear relationship between the width of my grin and the amount of uneasiness about issuing my previous utterance. <em>Hmmm. To be frank, I am not sure exactly who owns my current domain host.</em> Now the wheels in my head began turning (<em>Since I looked at that loony, old man</em>). I visited the site&hellip; tried searching for who the company was registered under. I couldn&rsquo;t find anything. It felt&hellip; wrong.</p>

<p>It turns out with a <a href="http://www.godaddy.com/reseller/domain-reseller.aspx?ci=21918">little</a> <a href="http://www.who.is/website-information/godaddy.com/">Internet</a> <a href="http://www.who.is/website-information/cheap-domainregistration.com/">detectivery</a>, I discovered that my now-late host was, in fact, a <strong>GoDaddy reseller.</strong></p>

<ol>
<li>The reseller template CDR used was the <em>first</em> reseller template available from GD, namely, &ldquo;Black, Yellow, and Red&rdquo;. You can see that by clicking &ldquo;Quick Tour&rdquo; on the GD Reseller page.</li>
<li>The addresses are the same for both WHOIS records. Coincidence?</li>
<li>The Legal Agreement for CDR also cites the same address.</li>
<li>CDR uses secureserver.net for DNS, which is owned by GoDaddy.</li>
</ol>


<p>Despair kicked in. I glanced at the brand new JA Henckels chef knife my friend got me for Christmas&mdash;the sharp blade, laser edged to perfection&hellip; it would be <em>so</em> easy to&mdash;&ldquo;No,&rdquo; I said. <em>Keep hold of yourself, man!</em></p>

<p>Turns out, there&rsquo;s a great host called <a href="http://namecheap.com">Namecheap.com</a> that is <a href="http://community.namecheap.com/blog/2011/12/22/we-say-no-to-sopa/">against SOPA</a> (as you should be). Needless to say, I&rsquo;ve initiated a bulk transfer of all my domains over to Namecheap. <a href="http://latersgd.com/">I&rsquo;ve done my part</a>.</p>

<p>So now the question is, are <strong>you</strong> inadvertently using a GoDaddy reseller? I highly recommend you double-check because you might just be surprised at what you find.</p>

<p><em>The more you know&hellip;</em></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/posts/27/using-cassette-for-semi-complicated-scenarios-upda">Using Cassette for Semi-complicated Scenarios [Updated 1/9/12]</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-12-22T21:24:19-06:00" pubdate data-updated="true">Dec 22<span>nd</span>, 2011</time>
        
           | <a href="/blog/posts/27/using-cassette-for-semi-complicated-scenarios-upda#disqus_thread"
             data-disqus-identifier="http://kamranicus.com/blog/posts/27/using-cassette-for-semi-complicated-scenarios-upda">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I love <a href="http://getcassette.net">Cassette</a>. You should too, because as of today, the project has gone MIT licensed which means <strong>you</strong>, my dear reader, can use it right now.</p>

<p>It&rsquo;s alright, I&rsquo;ll wait while you download it via Nuget. Done? Great.</p>

<h3>Updates</h3>

<ul>
<li><strong>1/9/12</strong>: Added print media example</li>
<li><strong>1/9/12</strong>: <a href="https://github.com/andrewdavey/cassette/issues/121">Issue #121</a> that I opened was fixed in the latest Cassette update, 1.0.1. I&rsquo;ve updated my samples accordingly.</li>
</ul>


<h3>More than a simple case</h3>

<p>Cassette is <a href="http://hanselminutes.com/260/net-api-design-that-optimizes-for-programmer-joy-with-jonathan-carter">optimized for programmer happiness</a>. It&rsquo;s easy to use and there&rsquo;s a lot of small features that make it stand out from the crowd (SquishIt, Combres, etc.). If you want to get started using Cassette out of the box, you only need to do a couple things and those things are outlined well <a href="http://getcassette.net/documentation/getting-started">in the documentation</a>.</p>

<p>What I love about Cassette is the flexibility you have when you need to go beyond the simplest use case. For example, let&rsquo;s consider the file structure I am working with on a project right now:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Web Project
</span><span class='line'> |_ Public
</span><span class='line'>   |_ images
</span><span class='line'>   |_ print
</span><span class='line'>     |_ print.css
</span><span class='line'>   |_ scripts
</span><span class='line'>     |_ i8n
</span><span class='line'>       |_ en-US
</span><span class='line'>       |_ zh-CN
</span><span class='line'>     |_ special
</span><span class='line'>       |_ modernizer-2.0.6.js
</span><span class='line'>     |_ vendor
</span><span class='line'>       |_ jquery-1.7.1.js
</span><span class='line'>       |_ other framework files...
</span><span class='line'>     |_ pages
</span><span class='line'>       |_ page1.js
</span><span class='line'>       |_ page2.js
</span><span class='line'>     |_ app.js
</span><span class='line'>   |_ themes
</span><span class='line'>     |_ jquery.ui.core.css
</span><span class='line'>     |_ other jQuery UI files
</span><span class='line'>   |_ base.css
</span><span class='line'>   |_ layout.css
</span><span class='line'>   |_ otherfiles...</span></code></pre></td></tr></table></div></figure>


<p>For the most part, this is how the project was organized and I needed to adapt Cassette to work here. I&rsquo;ll walk through a few things I needed to do first.</p>

<h3>File organization</h3>

<p>Before implementing Cassette, <a href="http://modernizr.com">Modernizr</a> was also in the <em>vendor</em> folder. In addition, the localized JS files in <em>i8n</em> were not in sub-folders according to their culture, they were just in <em>i8n</em>.</p>

<p>In the <em>vendor</em> folder, we have both minified and non-minified JS files (mostly from Nuget). We don&rsquo;t want Cassette to minify an already minified file. I&rsquo;ll show you how I avoided that later on.</p>

<p>I point this out because Cassette works better when things are organized so that they are &ldquo;bundlable.&rdquo; For that reason, I moved the files around so the structure looks like above. Since Modernizr has to be included in the page&rsquo;s <code>&lt;head&gt;</code> (it needs to load before the page loads to set up Respond media queries and HTML5 elements) and all other scripts can be included before the <code>&lt;/body&gt;</code> tag, I separated it into the <em>special</em> folder.</p>

<p>As for the <em>pages</em> scripts, these need to be only included on a per-page basis. If areas of your site need multiple assets, I would definitely move them into sub-folders (I would go a step farther perhaps and even include them by convention, the same way MVC plays with Views and Controllers but that&rsquo;s for another blog post!).</p>

<h3>Configuring the bundles</h3>

<p>I&rsquo;ll walk you through my Cassette configuration file. If you pull down Cassette via Nuget, you will have a new <code>CassetteConfiguration</code> file and class. This is what Cassette picks up and uses to bundle your files. You can move it wherever you want, Cassette magically picks it up. It is important to realize that if you want full control over how Cassette bundles your assets, you&rsquo;ll need to do some configuration. Luckily, it&rsquo;s not bad!</p>

<h4>Excluding directories, minified, and VSDoc files</h4>

<p>Out-of-the-box, Cassette does not provide an easy mechanism to exclude directories when adding bundles per sub-directory. The reason I think this is important is because we want to set up a general &ldquo;catch-all&rdquo; method to deal with bundling, namely: treat each directory as a bundle. That way we can add folders/files and have them bundled automatically for us. This creates less work for the team.</p>

<p>I also wanted to ignore any pre-minified or -vsdoc files (Cassette by default ignores vsdoc files).</p>

<p>To solve this issue, I just derived a class from <code>FileSearch</code> and added my own requirements:</p>

<script src="https://gist.github.com/1583784.js"></script>


<p>I could have also implemented my own <code>IFileSearch</code>, perhaps one that used a fluent interface to exclude directories or file suffixes, but for my limited needs, this would do well and I really only needed to build upon the out-of-the-box <code>FileSearch</code> class. Maybe I will implement a fluent search interface as a fun project.</p>

<p>The other thing I needed to add into the <em>Regex</em> was the ability to exclude any files ending in &ldquo;.min&rdquo; or &ldquo;-min&rdquo; (just in case). Cassette recommends you simply delete minified files. That&rsquo;s a good tip, except they&rsquo;ll just be back when you do a Nuget update, so why not just ignore them by default as well (<em>ahem</em>)?</p>

<p><em>Side note: It seems more efficient to me to allow Cassette to reference minified files but to bypass minification of them. Perhaps this will be implemented in the future?</em></p>

<h4>Configuring stylesheets</h4>

<p>For our project, we need to include Google Web Fonts in the page, in addition to the CSS files in the <em>public</em> directory. We keep the jQuery UI themes separate in case we update via Nuget so we can simply overwrite them.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">private</span> <span class="k">void</span> <span class="nf">ConfigureStylesheets</span><span class="p">(</span><span class="n">BundleCollection</span> <span class="n">bundles</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="c1">// Sub-folder bundled CSS</span>
</span><span class='line'>    <span class="n">bundles</span><span class="p">.</span><span class="n">AddPerSubDirectory</span><span class="p">&lt;</span><span class="n">StylesheetBundle</span><span class="p">&gt;(</span><span class="s">&quot;Public&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="k">new</span> <span class="nf">ExcludeDirectorySearch</span><span class="p">(</span><span class="s">&quot;*.css&quot;</span><span class="p">,</span> <span class="k">new</span><span class="p">[]</span> <span class="p">{</span> <span class="s">&quot;scripts&quot;</span> <span class="p">}));</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// Print media bundle</span>
</span><span class='line'>    <span class="n">bundles</span><span class="p">.</span><span class="n">Get</span><span class="p">&lt;</span><span class="n">StylesheetBundle</span><span class="p">&gt;(</span><span class="s">&quot;~/public/print&quot;</span><span class="p">).</span><span class="n">Media</span> <span class="p">=</span> <span class="s">&quot;print&quot;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// Google Web fonts</span>
</span><span class='line'>    <span class="n">bundles</span><span class="p">.</span><span class="n">AddUrlWithAlias</span><span class="p">&lt;</span><span class="n">StylesheetBundle</span><span class="p">&gt;(</span>
</span><span class='line'>        <span class="n">Scheme</span> <span class="p">+</span> <span class="s">&quot;://fonts.googleapis.com/css?family=Droid+Sans|Montserrat&quot;</span><span class="p">,</span> <span class="s">&quot;Fonts&quot;</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The first line tells Cassette to add a bundle per sub-directory, so the following bundles will be made:</p>

<ul>
<li>public (our CSS)</li>
<li>public\themes (jQuery UI)</li>
<li>public\print (print media)</li>
</ul>


<p>It also uses the class above and excludes the &ldquo;scripts&rdquo; directory from search, for good measure.</p>

<p>One of the caveats to the directory exclude is that it technically does <em>not</em> exclude directories; Cassette still creates empty bundles. Thus, if you tried to add a <code>~/public/print</code> bundle, you&rsquo;d get an exception saying that it already exists. So, we <em>cannot</em> exclude the <code>print</code> directory. Instead, you can reference it directly after it&rsquo;s been added and manually set the <code>Media</code> to print. Problem solved! Ideally, Cassette should not be creating empty bundles.</p>

<p>The second line includes the direct Google stylesheet reference aliased as <em>Fonts</em> (in references, <code>~/Fonts</code>). In this project, our site is behind a load balancer so SSL is terminated at the balancer. This means you can&rsquo;t just use the built-in ASP.NET <code>Request.IsSecureConnection</code> because by the time the request even hits the web server, SSL is not there. <strike>Therefore, I utilize one of the utilities we have to check if SSL is enabled via server headers that the balancer sets.</strike> The scheme is not identifiable yet in our <code>Application_Start</code>, so we cannot use this method, but I will leave it here for posterity. We switched to always using SSL since our site is under SSL to the user. <strong>Note:</strong> You can simply include fonts normally using the Google Font Loader or by a direct <code>&lt;link&gt;</code> reference, however, why not use Cassette if you&rsquo;re already going that route?</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="c1">// Also in CassetteConfiguration.cs</span>
</span><span class='line'><span class="k">private</span> <span class="kt">string</span> <span class="n">Scheme</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="n">Utilities</span><span class="p">.</span><span class="n">SharedUtils</span><span class="p">.</span><span class="n">IsSecureConnection</span><span class="p">()</span> <span class="p">?</span> <span class="s">&quot;https&quot;</span> <span class="p">:</span> <span class="s">&quot;http&quot;</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>In our <em>Layout.cshtml</em> file, we now need to reference these two bundles and render them to the page.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>@{
</span><span class='line'>    Bundles.Reference(&quot;public&quot;); // Our CSS
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span><span class='line'><span class="nt">&lt;html&gt;</span>
</span><span class='line'><span class="nt">&lt;head&gt;</span>
</span><span class='line'>    @Bundles.RenderStylesheets()
</span><span class='line'><span class="nt">&lt;/head&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>So how does Cassette understand in what order to put these references? First, Cassette goes by the order in which you call <code>@Bundles.Reference</code>. To make things easier though, I edited our main <em>layout.css</em> file to add Cassette-compatible references.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="c">/* For Cassette */</span>
</span><span class='line'><span class="c">/* @reference ~/Fonts base.css skeleton.css themes */</span>
</span></code></pre></td></tr></table></div></figure>


<p>When Cassette parses <em>layout.css</em>, it will detect these references. Since all files are included in our <em>public</em> bundle, everything goes great and the <code>&lt;link&gt;</code>&rsquo;s are added in order:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">&quot;http://fonts.googleapis.com/css?family=Droid+Sans|Montserrat&quot;</span> <span class="na">type=</span><span class="s">&quot;text/css&quot;</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span><span class="nt">/&gt;</span>
</span><span class='line'><span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">&quot;/_cassette/asset/Public/themes/jquery.ui.button.css?165be2c1b488debc298a8dbaa77347b326a0d2a2&quot;</span> <span class="na">type=</span><span class="s">&quot;text/css&quot;</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span><span class="nt">/&gt;</span>
</span><span class='line'><span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">&quot;/_cassette/asset/Public/themes/jquery.ui.core.css?e5bc0be5bec6729cd338579a99e89c39c844c181&quot;</span> <span class="na">type=</span><span class="s">&quot;text/css&quot;</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span><span class="nt">/&gt;</span>
</span><span class='line'><span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">&quot;/_cassette/asset/Public/themes/jquery.ui.datepicker.css?6243e68daf6d6b3c03ce47d66abef2feba488d94&quot;</span> <span class="na">type=</span><span class="s">&quot;text/css&quot;</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span><span class="nt">/&gt;</span>
</span><span class='line'><span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">&quot;/_cassette/asset/Public/themes/jquery.ui.dialog.css?45faa27d7c66d72df00c39c40506da46bed885e3&quot;</span> <span class="na">type=</span><span class="s">&quot;text/css&quot;</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span><span class="nt">/&gt;</span>
</span><span class='line'><span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">&quot;/_cassette/asset/Public/themes/jquery.ui.resizable.css?a1bf026ec6d01daa0f7853215774c9e3aeb8afa9&quot;</span> <span class="na">type=</span><span class="s">&quot;text/css&quot;</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span><span class="nt">/&gt;</span>
</span><span class='line'><span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">&quot;/_cassette/asset/Public/themes/jquery.ui.theme.css?83294a0e12785f8dac8d3f0de4bf65f481b55f13&quot;</span> <span class="na">type=</span><span class="s">&quot;text/css&quot;</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span><span class="nt">/&gt;</span>
</span><span class='line'><span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">&quot;/_cassette/asset/Public/base.css?6401a75dfde8196c81d8bb39c3e5fb25dab89ad1&quot;</span> <span class="na">type=</span><span class="s">&quot;text/css&quot;</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span><span class="nt">/&gt;</span>
</span><span class='line'><span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">&quot;/_cassette/asset/Public/skeleton.css?d7414571707853cafb3028441861d31291d60789&quot;</span> <span class="na">type=</span><span class="s">&quot;text/css&quot;</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span><span class="nt">/&gt;</span>
</span><span class='line'><span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">&quot;/_cassette/asset/Public/layout.css?0ac01597826664dcc3a6c031a61c11ffa17fdd3d&quot;</span> <span class="na">type=</span><span class="s">&quot;text/css&quot;</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span><span class="nt">/&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h4>Configuring Javascript</h4>

<p>The Javascript assets were a bit harder to configure; we needed to do a couple things:</p>

<ul>
<li>Auto-bundle everything except a few special cases</li>
<li>Have a &ldquo;special&rdquo; folder for <code>&lt;head&gt;</code> references</li>
<li>Avoid editing vendor file references so a Nuget update won&rsquo;t blow the changes away</li>
</ul>


<p>Here is my Javascript configuration:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">private</span> <span class="k">void</span> <span class="nf">ConfigureJavascript</span><span class="p">(</span><span class="n">BundleCollection</span> <span class="n">bundles</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="c1">// Localized JS - i8n/{culture}</span>
</span><span class='line'>    <span class="n">bundles</span><span class="p">.</span><span class="n">AddPerSubDirectory</span><span class="p">&lt;</span><span class="n">ScriptBundle</span><span class="p">&gt;(</span><span class="s">&quot;Public/scripts/i8n&quot;</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// Per-page JS (eventually may want separate folders as well)</span>
</span><span class='line'>    <span class="n">bundles</span><span class="p">.</span><span class="n">AddPerIndividualFile</span><span class="p">&lt;</span><span class="n">ScriptBundle</span><span class="p">&gt;(</span><span class="s">&quot;Public/scripts/pages&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// Bundle all scripts except special cases above</span>
</span><span class='line'>    <span class="n">bundles</span><span class="p">.</span><span class="n">AddPerSubDirectory</span><span class="p">&lt;</span><span class="n">ScriptBundle</span><span class="p">&gt;(</span><span class="s">&quot;Public/scripts&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="k">new</span> <span class="nf">ExcludeDirectorySearch</span><span class="p">(</span><span class="s">&quot;*.js&quot;</span><span class="p">,</span> <span class="k">new</span><span class="p">[]</span> <span class="p">{</span> <span class="s">&quot;i8n&quot;</span><span class="p">,</span> <span class="s">&quot;pages&quot;</span> <span class="p">}));</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Our configuration code above does exactly what we need. We can double check by browsing to <em>/_cassette</em> and seeing what Cassette decided to turn into bundles:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="p">~/</span><span class="n">Public</span><span class="p">/</span><span class="n">scripts</span>
</span><span class='line'>    <span class="n">app</span><span class="p">.</span><span class="n">js</span>
</span><span class='line'>
</span><span class='line'><span class="p">~/</span><span class="n">Public</span><span class="p">/</span><span class="n">scripts</span><span class="p">/</span><span class="n">pages</span>
</span><span class='line'>
</span><span class='line'><span class="p">~/</span><span class="n">Public</span><span class="p">/</span><span class="n">scripts</span><span class="p">/</span><span class="n">special</span>
</span><span class='line'>    <span class="n">modernizr</span><span class="p">-</span><span class="m">2.0</span><span class="p">.</span><span class="m">6.</span><span class="n">js</span>
</span><span class='line'>
</span><span class='line'><span class="p">~/</span><span class="n">Public</span><span class="p">/</span><span class="n">scripts</span><span class="p">/</span><span class="n">vendor</span>
</span><span class='line'>    <span class="n">jquery</span><span class="p">-</span><span class="m">1.7</span><span class="p">.</span><span class="m">1.</span><span class="n">js</span>
</span><span class='line'>    <span class="n">jquery</span><span class="p">-</span><span class="n">ui</span><span class="p">-</span><span class="m">1.8</span><span class="p">.</span><span class="m">16.</span><span class="n">js</span>
</span><span class='line'>    <span class="n">jQuery</span><span class="p">.</span><span class="n">tmpl</span><span class="p">.</span><span class="n">js</span>
</span><span class='line'>    <span class="n">jquery</span><span class="p">.</span><span class="n">validate</span><span class="p">.</span><span class="n">js</span>
</span><span class='line'>    <span class="n">jquery</span><span class="p">.</span><span class="n">validate</span><span class="p">.</span><span class="n">unobtrusive</span><span class="p">.</span><span class="n">js</span>
</span><span class='line'>
</span><span class='line'><span class="p">~/</span><span class="n">Public</span><span class="p">/</span><span class="n">scripts</span><span class="p">/</span><span class="n">i8n</span><span class="p">/</span><span class="n">zh</span><span class="p">-</span><span class="n">CN</span>
</span><span class='line'>    <span class="n">jquery</span><span class="p">.</span><span class="n">ui</span><span class="p">.</span><span class="n">datepicker</span><span class="p">-</span><span class="n">zh</span><span class="p">-</span><span class="n">CN</span><span class="p">.</span><span class="n">js</span>
</span><span class='line'>    <span class="n">jquery</span><span class="p">.</span><span class="n">validate</span><span class="p">-</span><span class="n">zh</span><span class="p">-</span><span class="n">CN</span><span class="p">.</span><span class="n">js</span>
</span><span class='line'>
</span><span class='line'><span class="p">~/</span><span class="n">Public</span><span class="p">/</span><span class="n">scripts</span><span class="p">/</span><span class="n">i8n</span><span class="p">/</span><span class="n">es</span><span class="p">-</span><span class="n">MX</span>
</span><span class='line'>    <span class="n">jquery</span><span class="p">.</span><span class="n">ui</span><span class="p">.</span><span class="n">datepicker</span><span class="p">-</span><span class="n">es</span><span class="p">-</span><span class="n">MX</span><span class="p">.</span><span class="n">js</span>
</span><span class='line'>    <span class="n">jquery</span><span class="p">.</span><span class="n">validate</span><span class="p">-</span><span class="n">es</span><span class="p">-</span><span class="n">MX</span><span class="p">.</span><span class="n">js</span>
</span><span class='line'>
</span><span class='line'><span class="p">~/</span><span class="n">Public</span><span class="p">/</span><span class="n">scripts</span><span class="p">/</span><span class="n">pages</span><span class="p">/</span><span class="n">page1</span><span class="p">.</span><span class="n">js</span>
</span><span class='line'>    <span class="p">~/</span><span class="n">Public</span><span class="p">/</span><span class="n">scripts</span><span class="p">/</span><span class="n">pages</span><span class="p">/</span><span class="n">page1</span><span class="p">.</span><span class="n">js</span>
</span><span class='line'>
</span><span class='line'><span class="p">~/</span><span class="n">Public</span><span class="p">/</span><span class="n">scripts</span><span class="p">/</span><span class="n">pages</span><span class="p">/</span><span class="n">page2</span><span class="p">.</span><span class="n">js</span>
</span><span class='line'>    <span class="p">~/</span><span class="n">Public</span><span class="p">/</span><span class="n">scripts</span><span class="p">/</span><span class="n">pages</span><span class="p">/</span><span class="n">page2</span><span class="p">.</span><span class="n">js</span>
</span></code></pre></td></tr></table></div></figure>


<p>You can see the exclusions worked, since the <em>pages</em> folder is blank (i.e. not bundled up) and each page script is made later on a per-file basis.</p>

<p>The reason I like this is because now I can just add folders to <em>scripts</em> without worrying about adding a manual Cassette bundle; it will just do it automatically and ignore the two folders I need to make a special case for.</p>

<p><strong>Including the script assets</strong></p>

<p>Remember I said Modernizr should be included in <code>&lt;head&gt;</code> but all the rest of the scripts should be before <code>&lt;/body&gt;</code>? We can do that easily with Cassette.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="err">@</span><span class="p">*</span> <span class="n">_Layout</span><span class="p">.</span><span class="n">cshtml</span> <span class="p">*</span><span class="err">@</span>
</span><span class='line'><span class="err">@</span><span class="p">{</span>
</span><span class='line'>    <span class="c1">// CSS</span>
</span><span class='line'>    <span class="n">Bundles</span><span class="p">.</span><span class="n">Reference</span><span class="p">(</span><span class="s">&quot;public&quot;</span><span class="p">);</span>
</span><span class='line'>  
</span><span class='line'>    <span class="c1">// Scripts (vendor first!)</span>
</span><span class='line'>    <span class="n">Bundles</span><span class="p">.</span><span class="n">Reference</span><span class="p">(</span><span class="s">&quot;public/scripts/special&quot;</span><span class="p">,</span> <span class="s">&quot;head&quot;</span><span class="p">);</span>
</span><span class='line'>    <span class="n">Bundles</span><span class="p">.</span><span class="n">Reference</span><span class="p">(</span><span class="s">&quot;public/scripts&quot;</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="p">&lt;!</span><span class="n">DOCTYPE</span> <span class="n">html</span><span class="p">&gt;</span>
</span><span class='line'><span class="p">&lt;</span><span class="n">html</span><span class="p">&gt;</span>
</span><span class='line'><span class="p">&lt;</span><span class="n">head</span><span class="p">&gt;</span>
</span><span class='line'>    <span class="n">@Bundles</span><span class="p">.</span><span class="n">RenderStylesheets</span><span class="p">()</span>
</span><span class='line'>  
</span><span class='line'>    <span class="err">@</span><span class="p">*</span> <span class="n">Modernizr</span> <span class="n">needs</span> <span class="n">to</span> <span class="n">be</span> <span class="n">first</span> <span class="p">*</span><span class="err">@</span>
</span><span class='line'>    <span class="n">@Bundles</span><span class="p">.</span><span class="n">RenderScripts</span><span class="p">(</span><span class="s">&quot;head&quot;</span><span class="p">)</span>
</span><span class='line'><span class="p">&lt;/</span><span class="n">head</span><span class="p">&gt;</span>
</span><span class='line'><span class="p">&lt;</span><span class="n">body</span><span class="p">&gt;</span>
</span><span class='line'>  
</span><span class='line'>    <span class="err">@</span><span class="p">*</span> <span class="n">All</span> <span class="n">other</span> <span class="n">scripts</span> <span class="p">*</span><span class="err">@</span>
</span><span class='line'>    <span class="n">@Bundles</span><span class="p">.</span><span class="n">RenderScripts</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'>    <span class="err">@</span><span class="p">*</span> <span class="n">Localized</span> <span class="n">scripts</span> <span class="p">*</span><span class="err">@</span>
</span><span class='line'>    <span class="n">@RazorHelpers</span><span class="p">.</span><span class="n">LocalizedScripts</span><span class="p">()</span>
</span><span class='line'><span class="p">&lt;/</span><span class="n">body</span><span class="p">&gt;</span>
</span><span class='line'><span class="p">&lt;/</span><span class="n">html</span><span class="p">&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Notice the reference for Modernizr. I am using the overloaded <code>Reference</code> that accepts a <code>pageLocation</code> argument. This is the same as how you can include Razor sections in MVC3. The location is just a string you use when you call <code>@Bundles.RenderScripts({pageLocation})</code>. <strong>Tip:</strong> You can also specify <code>pageLocation</code> when you create a bundle in your <code>CassetteConfiguration</code> class. I did not, since I only needed one script in the <code>head</code> tag, but if you have multiple folders or bundles that need to be in separate locations, you don&rsquo;t have to specify a page location in your view files.</p>

<p>As with our stylesheets, we need a way to tell Cassette how to order the vendor scripts since we typically have plugins that depend on each other (such as jQuery). You <em>could</em> edit each vendor file and manually add file references to them, but that&rsquo;s no fun is it? In order to reduce headaches and maintenance, create a <a href="http://getcassette.net/documentation/configuration/bundle-descriptor-file">Bundle Descriptor File</a> instead. That way, you will only need to keep that file up-to-date as you add more vendor plugins.</p>

<p>In the <em>vendors</em> folder, I simply made a <em>bundle.txt</em> file:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="n">jquery</span><span class="p">-</span><span class="m">1.7</span><span class="p">.</span><span class="m">1.</span><span class="n">js</span>
</span><span class='line'><span class="n">jquery</span><span class="p">-</span><span class="n">ui</span><span class="p">-</span><span class="m">1.8</span><span class="p">.</span><span class="m">16.</span><span class="n">js</span>
</span><span class='line'><span class="n">jQuery</span><span class="p">.</span><span class="n">tmpl</span><span class="p">.</span><span class="n">js</span>
</span><span class='line'><span class="n">jquery</span><span class="p">.</span><span class="n">validate</span><span class="p">.</span><span class="n">js</span>
</span><span class='line'><span class="n">jquery</span><span class="p">.</span><span class="n">validate</span><span class="p">.</span><span class="n">unobtrusive</span><span class="p">.</span><span class="n">js</span>
</span><span class='line'><span class="p">*</span>
</span></code></pre></td></tr></table></div></figure>


<p>The wildcard at the end tells Cassette, &ldquo;Yo, do whatever you want for the rest of the scripts you find.&rdquo; How useful! Now there&rsquo;s even <em>less</em> maintenance (didn&rsquo;t I tell you this baby was optimized for happiness?).</p>

<p>For localization, I just created a Razor helper to include the right culture files for me (this shows you that you can use the <code>Bundles</code> object anywhere in your Razor views and Cassette will include the references):</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="c1">//</span>
</span><span class='line'><span class="c1">// ~/App_Code/RazorHelpers.cshtml</span>
</span><span class='line'><span class="c1">//</span>
</span><span class='line'><span class="n">@helper</span> <span class="nf">LocalizedScripts</span><span class="p">()</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>    <span class="kt">string</span> <span class="n">cultureName</span> <span class="p">=</span> <span class="n">System</span><span class="p">.</span><span class="n">Threading</span><span class="p">.</span><span class="n">Thread</span><span class="p">.</span><span class="n">CurrentThread</span><span class="p">.</span><span class="n">CurrentCulture</span><span class="p">.</span><span class="n">Name</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">cultureName</span> <span class="p">!=</span> <span class="n">Constants</span><span class="p">.</span><span class="n">DefaultCulture</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="n">Bundles</span><span class="p">.</span><span class="n">Reference</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">&quot;/public/scripts/i8n/{0}&quot;</span><span class="p">,</span> <span class="n">cultureName</span><span class="p">));</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>And on individual views, I can now included page-specific JS:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="err">@</span><span class="p">*</span> <span class="n">Views</span><span class="err">\</span><span class="n">Controller1</span><span class="err">\</span><span class="n">View1</span><span class="p">.</span><span class="n">cshtml</span> <span class="p">*</span><span class="err">@</span>
</span><span class='line'><span class="err">@</span><span class="p">{</span>
</span><span class='line'>    <span class="n">Bundles</span><span class="p">.</span><span class="n">Reference</span><span class="p">(</span><span class="s">&quot;~/public/scripts/pages/page1.js&quot;</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Cassette is smart and will include the JS automatically in the <em>Layout.cshtml</em> file <em>and</em> in the proper order (in my case, just at the end. If you had references inside, Cassette would know).</p>

<h4>To debug or not to debug, that is the question!</h4>

<p>In our environment, we don&rsquo;t necessarily want to turn off Cassette as soon as the web.config&rsquo;s <code>debug</code> flag turns to <em>false</em>. Instead, we have different environments where it might make sense to leave Cassette on. When the site goes out to QA, then it makes sense to turn on Cassette&rsquo;s Release mode, but while developing locally and in staging, we may need to debug a bit more.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">public</span> <span class="k">void</span> <span class="nf">Configure</span><span class="p">(</span><span class="n">BundleCollection</span> <span class="n">bundles</span><span class="p">,</span> <span class="n">CassetteSettings</span> <span class="n">settings</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="c1">// Debug locally and in staging</span>
</span><span class='line'>  <span class="n">settings</span><span class="p">.</span><span class="n">IsDebuggingEnabled</span> <span class="p">=</span>
</span><span class='line'>      <span class="n">Server</span><span class="p">.</span><span class="n">CurrentEnvironment</span> <span class="p">==</span> <span class="n">Server</span><span class="p">.</span><span class="n">ServerEnvironment</span><span class="p">.</span><span class="n">Developer</span> <span class="p">||</span>
</span><span class='line'>      <span class="n">Server</span><span class="p">.</span><span class="n">CurrentEnvironment</span> <span class="p">==</span> <span class="n">Server</span><span class="p">.</span><span class="n">ServerEnvironment</span><span class="p">.</span><span class="n">Development</span><span class="p">;</span>
</span><span class='line'>  
</span><span class='line'>  <span class="n">ConfigureStylesheets</span><span class="p">(</span><span class="n">bundles</span><span class="p">);</span>
</span><span class='line'>  <span class="n">ConfigureJavascript</span><span class="p">(</span><span class="n">bundles</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>And there&rsquo;s my full <code>CassetteConfiguration</code> class!</p>

<h3>So what are you waiting for?</h3>

<p>Cassette is awesome and I hope you learned a couple tips for doing things in a semi-complex environment. Let me know if you&rsquo;ve found any more good tips &amp; tricks, or if you notice I missed an optimization or hidden feature.</p>

<p>I would really like to do some performance testing with Cassette. It <em>does</em> add to your overhead on the site, but in my Firebug timings, I noticed much less time being spent on CSS files and more time being spent on JS files. If you are worried about performance on a massive scale, it will <strong>always</strong> be faster to minify and concatenate your files at compile or build time because then IIS is serving the files directly. Components like Cassette are meant to ease your burden by handling that for you, at the expense of some milliseconds. Remember that due to caching and aggressive expiration headers, the browser should <em>not</em> be requesting assets anyway after the first request.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/posts/26/tips-when-using-backbonejs-in-a-net-world">Tips When Using Backbone.js in a .NET World</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-12-15T20:37:51-06:00" pubdate data-updated="true">Dec 15<span>th</span>, 2011</time>
        
           | <a href="/blog/posts/26/tips-when-using-backbonejs-in-a-net-world#disqus_thread"
             data-disqus-identifier="http://kamranicus.com/blog/posts/26/tips-when-using-backbonejs-in-a-net-world">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I am learning <a href="http://documentcloud.github.com/backbone/">Backbone.js</a> so I can re-write the main GUI for <a href="http://keeptrackofmygames.com">KTOMG</a>. I am still learning and I&rsquo;ve run into a couple gotchas that I hope I can clear up for anyone else that dares to tread in these woods. Still, I&rsquo;ve been able to rewrite the listing of a user&rsquo;s library in one night using Backbone and all my existing back-end code (the farthest up I edited was my controller). Very impressive for a Backbone n00b!</p>

<h2>Backbone IS your application</h2>

<p>After watching the <a href="http://peepcode.com/products/backbone-iii">PeepCode screencasts</a> (I, II, and III), I have realized something about Backbone.</p>

<blockquote><p>Backbone will pretty much replace your MVC views and controller logic.</p></blockquote>

<p>This didn&rsquo;t hit me until the last episode and at first, this felt threatening. I am working in ASP.NET MVC and it feels wrong to not utilize it. After thinking about it some more, however, there were a few important points to consider:</p>

<ol>
<li>Backbone doesn&rsquo;t <em>necessarily</em> have to be your whole app. In fact, right now I am only using Backbone for the main &ldquo;library&rdquo; interface and I am keeping the rest of the site in plain-old MVC 3.</li>
<li>You still use your controllers and could even use your Razor views as HTML templates.</li>
</ol>


<p>Considering those points, I felt a lot better about using Backbone. Not only will it be a great experience, it&rsquo;ll also make the most important part of my application very responsive and robust, without needing to worry a ton about the plumbing.</p>

<p>Who knows? Maybe KTOMG will be running on Node.js by the end of the month.</p>

<h2>Tips When Using Backbone with ASP.NET MVC</h2>

<p>There were a few gotchas I ran into when using Backbone in my typical .NET environment.</p>

<h3>Use AttributeRouting, like, now</h3>

<p><a href="https://github.com/mccalltd/AttributeRouting">AttributeRouting</a> is one of my new favorite packages. It axes the mostly-confusing, mostly-convoluted Global.asax way of handling routes in favor of a more-discoverable (I feel) way of doing routes by decorating actual controller methods:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">using</span> <span class="nn">AttributeRouting</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="na">[RoutePrefix(&quot;games&quot;)]</span>
</span><span class='line'><span class="k">public</span> <span class="k">class</span> <span class="nc">GamesController</span> <span class="p">:</span> <span class="n">Controller</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">//</span>
</span><span class='line'>  <span class="c1">// GET: /games/</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">[</span><span class="n">GET</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">)</span>
</span><span class='line'>  <span class="k">public</span> <span class="n">ActionResult</span> <span class="nf">Index</span><span class="p">()</span> <span class="p">{}</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">//</span>
</span><span class='line'>  <span class="c1">// POST: /games/</span>
</span><span class='line'>
</span><span class='line'>  <span class="p">[</span><span class="n">POST</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">)</span>
</span><span class='line'>  <span class="k">public</span> <span class="n">ActionResult</span> <span class="nf">New</span><span class="p">(</span><span class="n">Model</span> <span class="n">model</span><span class="p">)</span> <span class="p">{}</span>
</span><span class='line'>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Hopefully you will see why this is useful. Backbone is opinionated in that it assumes you&rsquo;re using a RESTful interface for your API. In normal vanilla MVC, this could turn your Global.asax into a routing nightmare. However, with AttributeRouting, it&rsquo;s easy! Here&rsquo;s an example of a <a href="http://stackoverflow.com/a/6263133/109458">Backbone-compatible REST controller</a>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">using</span> <span class="nn">AttributeRouting</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="na">[RoutePrefix(&quot;api/games&quot;)]</span>
</span><span class='line'><span class="k">public</span> <span class="k">class</span> <span class="nc">GamesApiController</span> <span class="p">:</span> <span class="n">Controller</span> <span class="p">{</span>
</span><span class='line'>  
</span><span class='line'>  <span class="c1">//</span>
</span><span class='line'>  <span class="c1">// GET: /api/games/</span>
</span><span class='line'><span class="na"> </span>
</span><span class='line'><span class="na"> [GET(&quot;&quot;)]</span>
</span><span class='line'>  <span class="k">public</span> <span class="n">JsonResult</span> <span class="nf">Index</span><span class="p">()</span> <span class="p">{}</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">//</span>
</span><span class='line'>  <span class="c1">// POST: /api/games/</span>
</span><span class='line'><span class="na"> </span>
</span><span class='line'><span class="na"> [POST(&quot;&quot;)]</span>
</span><span class='line'>  <span class="k">public</span> <span class="n">JsonResult</span> <span class="nf">Create</span><span class="p">()</span> <span class="p">{}</span>
</span><span class='line'>  
</span><span class='line'>  <span class="c1">//</span>
</span><span class='line'>  <span class="c1">// GET: /api/games/{id}</span>
</span><span class='line'><span class="na"> </span>
</span><span class='line'><span class="na"> [GET(&quot;{id}&quot;)]</span>
</span><span class='line'>  <span class="k">public</span> <span class="n">JsonResult</span> <span class="nf">Show</span><span class="p">(</span><span class="kt">int</span> <span class="n">id</span><span class="p">)</span> <span class="p">{}</span>
</span><span class='line'>  
</span><span class='line'>  <span class="c1">//</span>
</span><span class='line'>  <span class="c1">// PUT: /api/games/{id}</span>
</span><span class='line'><span class="na"> </span>
</span><span class='line'><span class="na"> [PUT(&quot;{id}&quot;)]</span>
</span><span class='line'>  <span class="k">public</span> <span class="n">JsonResult</span> <span class="nf">Update</span><span class="p">(</span><span class="kt">int</span> <span class="n">id</span><span class="p">)</span> <span class="p">{}</span>
</span><span class='line'>  
</span><span class='line'>  <span class="c1">//</span>
</span><span class='line'>  <span class="c1">// DELETE: /api/games/{id}</span>
</span><span class='line'><span class="na"> </span>
</span><span class='line'><span class="na"> [DELETE(&quot;{id}&quot;)]</span>
</span><span class='line'>  <span class="k">public</span> <span class="n">JsonResult</span> <span class="nf">Delete</span><span class="p">(</span><span class="kt">int</span> <span class="n">id</span><span class="p">)</span> <span class="p">{}</span>
</span><span class='line'>  
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Good fodder for a T4 template. If you have a larger site, consider using an <code>Api</code> MVC Area for cleaner separation.</p>

<h3>Be careful when serializing your objects</h3>

<p>I ran into two gotchas with serializing my objects.</p>

<p>First, if you have an <code>Id</code> property/field, Backbone will not be happy. <strike>It needs to be lowercase id</strike>. You should utilize the <a href="https://github.com/documentcloud/backbone/blob/master/backbone.js#L153https://github.com/documentcloud/backbone/blob/master/backbone.js#L153"><code>idAttribute</code></a> option on your Backbone model to override the property name. It took me forever to figure out why nothing was happening when I deleted a model.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kr">class</span> <span class="nx">MyModel</span> <span class="kr">extends</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Model</span>
</span><span class='line'>  <span class="nx">idAttribute</span><span class="o">:</span> <span class="s2">&quot;Id&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Second, if you are going to serialize EF entities when proxying or lazy-loading is enabled, you need to use a serialization framework like <a href="http://json.codeplex.com/">JSON.NET</a> <strong>or</strong> you need to make flat DTO objects (or view models). I opted for the latter approach first because it was quick, but I am in the process of implementing JSON.NET to do serialization of my entities for me.</p>

<p>For EF serialization, you need to use a custom <code>ContractResolver</code>. I borrowed <a href="http://stackoverflow.com/questions/6991596/serializing-ef4-1-entities-using-json-net">this one</a>. Furthermore, I also needed to set the <code>ReferenceLoopHandling</code> to <code>Ignore</code> on a new <code>JsonSerializerSettings</code> object so it would avoid circular references.</p>

<p>Finally, this is optional but considering the first gotcha, I highly recommend you inherit the EF contract resolver above from <code>CamelCasePropertyNamesContractResolver</code> so your JSON is serialized with camelCase properties.</p>

<h3>Consider leveraging Razor/ASPX partial views for your templates</h3>

<p>I haven&rsquo;t actually tried this, but I don&rsquo;t see why it wouldn&rsquo;t work. In a Backbone project you&rsquo;ll typically have plenty of templates. Right now I have 3 but I expect it to grow quite a bit in the future. I was planning on moving all these templates to <code>.cshtml</code> files and then using <code>@Html.Partial("_TemplateName")</code> to include them in my main layout. I may even create a small extension method to wrap that in a <code>&lt;script&gt;</code> tag. I will update this post if I do.</p>

<p>If you happen to be working on an OSS project, you should be using <a href="http://getcassette.net">Cassette</a> because it can package up your HTML/Knockout templates and <a href="http://getcassette.net/documentation/html-templates">include them all in your page for you</a> <strong>automagically</strong>. If I wasn&rsquo;t using AppHarbor and I was using a dedicated server, I would buy Cassette in a second. I wish they had per-site licenses.</p>

<h3>Use those organization skills</h3>

<p>ASP.NET MVC comes with a friendly and intuitive file layout out-of-the-box:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">Project</span>
</span><span class='line'> <span class="o">|</span><span class="nx">_</span> <span class="nx">Controllers</span>
</span><span class='line'> <span class="o">|</span><span class="nx">_</span> <span class="nx">Models</span>
</span><span class='line'> <span class="o">|</span><span class="nx">_</span> <span class="nx">Scripts</span>
</span><span class='line'> <span class="o">|</span><span class="nx">_</span> <span class="nx">Styles</span>
</span><span class='line'> <span class="o">|</span><span class="nx">_</span> <span class="nx">Views</span>
</span></code></pre></td></tr></table></div></figure>


<p>I&rsquo;ve shortened mine, plus I&rsquo;ve made my scripts directory a bit more Backbone friendly:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">Project</span>
</span><span class='line'> <span class="o">|</span><span class="nx">_</span> <span class="nx">Controllers</span>
</span><span class='line'> <span class="o">|</span><span class="nx">_</span> <span class="nx">Models</span>
</span><span class='line'> <span class="o">|</span><span class="nx">_</span> <span class="nx">Public</span>
</span><span class='line'>   <span class="o">|</span><span class="nx">_</span> <span class="nx">Images</span>
</span><span class='line'>   <span class="o">|</span><span class="nx">_</span> <span class="nx">Scripts</span>
</span><span class='line'>     <span class="o">|</span><span class="nx">_</span> <span class="nx">App</span>
</span><span class='line'>       <span class="o">|</span><span class="nx">_</span> <span class="nx">Collections</span><span class="p">.</span><span class="nx">coffee</span>
</span><span class='line'>       <span class="o">|</span><span class="nx">_</span> <span class="nx">Backbone</span> <span class="nx">CoffeeScript</span> <span class="nx">files</span>
</span><span class='line'>     <span class="o">|</span><span class="nx">_</span> <span class="nx">Framework</span> <span class="p">(</span><span class="nx">or</span> <span class="nx">Vendor</span><span class="p">)</span>
</span><span class='line'>   <span class="o">|</span><span class="nx">_</span> <span class="nx">scss</span> <span class="nx">files</span><span class="p">...</span>
</span><span class='line'> <span class="o">|</span><span class="nx">_</span> <span class="nx">Views</span>
</span></code></pre></td></tr></table></div></figure>


<p>It&rsquo;s up to you how you like to organize, and perhaps you&rsquo;d even like to separate it further down into modules.</p>

<h3>Learn CoffeeScript and SASS</h3>

<p>This technically does not have anything to do with .NET or Backbone. However, your life will be <em>easier</em> if you learn CoffeeScript as that makes using Backbone that much more pleasant:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kr">class</span> <span class="nx">GameView</span> <span class="kr">extends</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">View</span>
</span><span class='line'>  <span class="nx">className</span><span class="o">:</span> <span class="s1">&#39;game&#39;</span>
</span><span class='line'>  <span class="nx">template</span><span class="o">:</span> <span class="nx">_</span><span class="p">.</span><span class="nx">template</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#game-template&quot;</span><span class="p">).</span><span class="nx">html</span><span class="p">())</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">initialize</span><span class="o">:</span> <span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="o">-&gt;</span>
</span><span class='line'>    <span class="err">@</span><span class="nx">model</span><span class="p">.</span><span class="nx">bind</span> <span class="s1">&#39;change&#39;</span><span class="p">,</span> <span class="err">@</span><span class="nx">render</span><span class="p">,</span> <span class="err">@</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">render</span><span class="o">:</span> <span class="o">-&gt;</span>
</span><span class='line'>    <span class="nx">$</span><span class="p">(</span><span class="err">@</span><span class="nx">el</span><span class="p">).</span><span class="nx">html</span> <span class="err">@</span><span class="nx">template</span><span class="p">()</span>
</span><span class='line'>    <span class="err">@</span> <span class="err">#</span> <span class="nx">Never</span> <span class="nx">forget</span> <span class="k">this</span> <span class="nx">line</span> <span class="k">in</span> <span class="nx">render</span><span class="p">()</span> <span class="nx">or</span> <span class="nx">you</span><span class="err">&#39;</span><span class="nx">ll</span> <span class="nx">regret</span> <span class="nx">it</span>
</span></code></pre></td></tr></table></div></figure>


<p>(<em>Disclaimer:</em> This is not real and won&rsquo;t run; it&rsquo;s meant as an illustration of Backbone in CoffeeScript)</p>

<p>It&rsquo;s much nicer to write in Backbone without all those pesky parenthesis and manual <code>bindAll</code> or <code>extend</code> shenanigans. Again, I&rsquo;d recommend <a href="http://peepcode.com/products/coffeescript">PeepCode&rsquo;s CoffeeScript screencast</a>, that&rsquo;s about all it takes to learn it properly.</p>

<p><img src="http://www.mindscapehq.com/upload/web-workbench/preview.png" alt="Mindscape Example" /></p>

<p>If you do decide to take the plunge (it&rsquo;s worth it!), get yourself <a href="http://www.mindscapehq.com/products/web-workbench">Mindscape Web Workbench</a> and you&rsquo;ll be a much happier camper when working with Coffee, SASS, and LESS in Visual Studio.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/posts/25/vs-extension-for-js-template-support">Vs Extension for JS Template Support</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-12-14T14:27:33-06:00" pubdate data-updated="true">Dec 14<span>th</span>, 2011</time>
        
           | <a href="/blog/posts/25/vs-extension-for-js-template-support#disqus_thread"
             data-disqus-identifier="http://kamranicus.com/blog/posts/25/vs-extension-for-js-template-support">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I am thinking of embarking on a journey that involves <a href="http://documentcloud.github.com/backbone/">Backbone.js</a> in my MVC 3 project. This would involve heavy use of templating. After thinking about it a bit and doing some Googling, I realized that <strong>there is no JS template extension for Visual Studio.</strong></p>

<p>I realize that you could just name your template files &ldquo;.html&rdquo; and be done with it. However, I feel like that isn&rsquo;t &ldquo;cool&rdquo; enough.</p>

<p>Based on some <a href="http://stackoverflow.com/questions/3253205/how-do-i-visual-studio-syntax-highlighting-extension">preliminary research</a>, it seems to me it would not be impossible to add support for common JS template syntax highlighting&hellip; and perhaps even Intellisense.</p>

<p>In fact, VS 11 <a href="http://blogs.msdn.com/b/webdevtools/archive/2011/09/15/new-javascript-editing-features-for-web-development-in-visual-studio-11-developer-preview.aspx">will support jQuery Template syntax highlighting</a>, but not only is jquery-tmpl <a href="http://weblogs.asp.net/stevewellens/archive/2011/12/01/goodby-jquery-templates-hello-jsrender.aspx">obsolete</a>, it is also not the <a href="http://jsperf.com/dom-vs-innerhtml-based-templating/112">only kind of templating system</a>.</p>

<p>Why am I making this post? I am not sure. Part of me wants to attempt to make such an extension, probably starting out with a simple template syntax like <a href="http://mustache.github.com/">Mustache</a> (or <a href="http://www.handlebarsjs.com/">Handlebars</a>). I would be happy with an extension that was pretty much an HTML highlighter that also highlighted tokens (e.g. &ldquo;, &rdquo;, etc.) just like VS does for Razor. Bonus points awarded if it [somehow] does Intellisense. In my dream world, it would act very much like MVC Razor does right now, where you declare the &ldquo;model&rdquo; for the template and that is its context for Intellisense. To me, that seems reasonable for a no-logic template system like Mustache but may prove unwieldy once you allow for normal JS expressions like in jquery-tmpl. That kind of syntax may also not make sense in the first place considering you could pass in whatever you wanted into a template&rsquo;s context.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/posts/24/skyrim-mod-request-compilation">Skyrim Mod Request Compilation</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-11-14T16:41:56-06:00" pubdate data-updated="true">Nov 14<span>th</span>, 2011</time>
        
           | <a href="/blog/posts/24/skyrim-mod-request-compilation#disqus_thread"
             data-disqus-identifier="http://kamranicus.com/blog/posts/24/skyrim-mod-request-compilation">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>These are for ideas for myself to explore or for others to get ideas from (or help make!). I&rsquo;m not a modder, really, I&rsquo;ve never done a TES mod before. Skyrim, however, has motivated me to at least explore the option of making mods. I can&rsquo;t design a model worth crap, so many of my ideas will be focused on stuff I could possibly do myself. I&rsquo;ll note ones that I think other people might want to tackle (<strong> denotes someone else should please make it</strong>).</p>

<p>I will be keeping this updated for myself, mostly, but I could also add mods people suggest underneath if I think I could possibly do them (I can handle scripting/tweak/UI mods I think, just not art-based ones). I&rsquo;d love constructive feedback (either <em>why</em> my idea sucks or <em>how</em> it could be improved).</p>

<h3>Updates</h3>

<ul>
<li><strong>[11/15/11]</strong> Added chest categories, linked inventory sorting</li>
<li><strong>[11/14/11]</strong> Initial list</li>
</ul>


<h2>Possibly Possible Mods</h2>

<p>Mods that should be possible given what I know about past TES mods.</p>

<p><strong>Non-Levelled Epic Loot</strong></p>

<p>In the words of my friend, &ldquo;It saddens me to realize that the Cuirass of the Savior&rsquo;s Hide that I just found will be worthless after the next 10 levels I grow.&rdquo; Epic loot should be epic and possibly protected by insane bosses to keep some semblance of balance. This is one big thing that disappoints me about Skyrim.</p>

<p><strong>Poisoned Food</strong></p>

<p>Mostly a for-fun mod. Poison apples were awesome in Oblivion and I&rsquo;m surprised you can&rsquo;t apply poison to food.</p>

<p><strong>Follower Bonuses</strong></p>

<p>Like Fallout. Followers all have different skill/perk bonuses that you get when you have them in your party. If perk unlocking isn&rsquo;t possible, maybe simply stat-based (i.e. Lydia gives you +10% to One-Handed and +5% to Blocking). This would make followers a bit more strategic.</p>

<p><strong>Follower Home Base</strong> </p>

<p>Like Fallout, if this isn&rsquo;t already in the game, followers you recruit should return to your home (if it&rsquo;s big enough). Easier to find them if you dismiss them plus makes you feel loved and a true Dovahkiin. &ldquo;Sorry, honey, we&rsquo;ll be having guests over&hellip; for awhile.&rdquo;</p>

<p><strong>Follower Map Indicator</strong></p>

<p>Like Fallout (right?), show followers on your map so it&rsquo;s easier to find them when they&rsquo;re lost. Or to be immersive, a spell ala Clairvoyance?</p>

<p><strong>Horse Whistle</strong></p>

<p>Already suggested. An item that summons your horse ala Red Dead (except probably instant due to modding capability).</p>

<p><strong>Salvage Weapons and Apparel</strong> </p>

<p>I don&rsquo;t know what the official term is, but the ability to break down weapons/apparel into their component parts (&ldquo;Salvage&rdquo;?). To keep balance, I&rsquo;d add a percent chance based on your smithing skill. Should be realistic based on actual weapon (sword yields more steel than a dagger).</p>

<p><strong>Enchanted Pickaxes</strong></p>

<p>Pickaxes can be enchanted or can be found randomly, that have enhanced chance to find treasure (rubies, gems, etc).</p>

<p><strong>Family</strong> </p>

<p>When married, you can hit the bed and have children ala Fable. Kids grow into teens into adults (adult vs. teen doesn&rsquo;t seem to be differentiated in Skyrim), they have random jobs, and maybe can turn into followers (complicated?). There&rsquo;s probably much more to this I am not thinking of right now, as far as potential gameplay additions.</p>

<p><strong>Notice/Bounty Boards</strong> </p>

<p>Talking to inn keepers to get bounties is cool but I loved Dragon Age&rsquo;s notice boards at the Chantry. I think the ability to randomize quests using Radiant AI would make this a sweet, sweet mod for adventurers like me. Quests could be: fetch items, kill bandits, clear out caves, help farmers, collect crafting items, deliver goods, etc.</p>

<p><strong>Multi-Ring</strong></p>

<p><a href="http://www.reddit.com/r/skyrimmods/comments/meivy/request_allow_more_than_one_ring_to_be_equipped/">Already suggested</a>. I&rsquo;m sure this wasn&rsquo;t included due to balance. I&rsquo;d like to wear at least two rings, and maybe disable stacking (i.e. wearing two +20% health regen rings).</p>

<p><strong>Multi-enchant</strong></p>

<p>I could be wrong but I don&rsquo;t think you can have more than 1 enchantment on an item. Again, perhaps for balance. I&rsquo;d love to see the ability to do this, maybe depending on enchantment skill/perk.</p>

<p><strong>More Jobs</strong> </p>

<p>This would probably need to be done by someone who can do animations/modeling. I&rsquo;d love to see more jobs you can do, maybe that have to do with fishing, clothing, hunting, etc. You know, what people would do for a living in Skyrim!</p>

<p><strong>Harder Dragons</strong></p>

<p>Is it just me or are the low-level dragons way too easy? It only takes 5-8 hits of my two-handed warhammer to kill one&hellip; that seems too little. Dragons should be, &ldquo;Shit I have to use up all these potions and take cover and blah blah CRAP CRAP&rdquo; encounters&hellip; like a Draugr Overlord.</p>

<p><strong>Huge castle/house</strong> </p>

<p>No doubt someone will do this. I&rsquo;d like to see mannequins, display cases, and stuff so I can show off every cool item I find. It&rsquo;s also great for people like me who wish to collect every piece of armor and weapon to have one of each in a &ldquo;museum&rdquo; type setting.</p>

<p><strong>Build-a-town</strong> </p>

<p>A large undertaking. Basically the equivalent of your home settlement in Assassin&rsquo;s Creed where you can buy shops, etc. Invest/upgrade them, hire people, etc. for cash flow. Bandits can attack and destroy stores. Shopkeepers can steal money from you. Dragons can attack. Guards can be hired (maybe quests for each kind, like do something for the Jarl to gain his trust and send over guards). Your home can be expanded. This would be one epic mod but boy, oh boy, would it be awesome.</p>

<p><strong>Better Bookcases</strong></p>

<p>Anyone else disappointed in the built-in bookcases for your home? How come only 9 books can be on a shelf when clearly there is more room for at least 4-5 more? I don&rsquo;t want to come off as a slob to my wife or followers.</p>

<p><strong>Better Housing Equipment</strong> </p>

<p>While you can add a lab to some houses, I&rsquo;d like to also invest in an armory (smithing) and extra storage (chests) for my house. This I&rsquo;m sure will be the way the huge housing mods go, though, but I&rsquo;d rather earn that stuff than have it just appear in my house because of a mod. Make me pay 5000 gold for an armory, that&rsquo;s pretty motivating. To make it even sweeter, like Fallout, add some bonuses you get for using your own equipment.</p>

<p><strong>Crafting Recipes</strong></p>

<p>Is it just me or is it a little weird that all I need is a perk to create entire sets of items? This is fun but I was thinking it might be more challenging to require every item to have a recipe you need to find out in the world/merchants instead. Just like Fallout blueprints. Or, generate a recipe on an item you already own.</p>

<h2>Possibly Impossible Mods</h2>

<p>Mods that may or may not be possible, but seems like they won&rsquo;t be.</p>

<p><strong>Vanity Mod</strong></p>

<p><a href="http://www.reddit.com/r/skyrimmods/comments/m2quz/request_vanity_mod_for_inventory_screen/">Already suggested by me</a>, one of the top-voted requests that I&rsquo;ve seen on /r/skyrimmods. Ability to see your character, somehow, when equipping items. Workaround is to use 3rd person and position the camera but this can only be done with your weapon sheathed.</p>

<p><strong>Better Custom Map Markers</strong></p>

<p>I like that you can add a map marker as a waypoint, but I better like the idea of Morrowind&rsquo;s custom markers that I can add notes to. Ability to add any number of custom markers to world/local map and add a note/caption.</p>

<p><strong>Follower Back Stories</strong> </p>

<p>This was one of the more fun things in Dragon Age. Followers actually had back stories and you could do quests for them to retrieve a family heirloom, save them from assassins, etc. In a game like Skyrim or DA where everyone is voiced&hellip; this seems like a lot of work, especially because it would seem weird to have followers have a different voice.</p>

<p><strong>Follower Salesman</strong></p>

<p>This was an idea from my friend. Borrow the mechanic from Torchlight where you can send your follower back to the closest major city and sell all the goods he&rsquo;s carrying (excepting &ldquo;equipped&rdquo; items probably). I <em>think</em> this is possible but I assume it&rsquo;d take a lot of scripting work. Add a cooldown same as Torchlight where your companion will be gone for awhile before returning. The companion can be carrying the gold he/she got from the transaction or just have it added automatically. If possible, this should be a perk, perhaps in the Speech tree.</p>

<p><strong>Better Container States</strong></p>

<p>I love how Fallout and beyond show what containers are &ldquo;Empty.&rdquo; However, I&rsquo;m a little peeved they also don&rsquo;t show you what&rsquo;s been searched. To be immersive, perhaps all one has to do is make a mod that keeps containers in the &ldquo;open&rdquo; state after you look at them, but at the least, it should show a &ldquo;Searched&rdquo; status when you hover over just like Empty.</p>

<p><strong>Item Sets</strong></p>

<p>Favorites are cool but I&rsquo;d love to see item set capability, maybe as &ldquo;favoritable&rdquo; themselves or a separate menu. Basically, I typically play 3 ways in combat: brawler, mage murderer, and ranger. I&rsquo;d love to make it even easier by adding apparel to equip in addition to weapons for those situations. For example, for my mage murderer situation: equip my custom weapon, Mage Bane that does a ton of magicka damage on hit, equip an armor piece(s) that give me magicka resistance, etc. For brawler, equip my warhammer, armor that regens stamina faster or fortifies it, etc. You get the idea. Maybe this is as simple as allowing one number to be associated to multiple items. This seems like a code change, though.</p>

<p><strong>Quest Vicinities</strong></p>

<p>Because disabling map markers and your compass could easily make things a huge pain in the ass, even though it&rsquo;s &ldquo;immersive&rdquo;, I think a good balance would be the ability to disable quest markers and &ldquo;unvisited&rdquo; locations and instead present a Red Dead Redemption like &ldquo;vicinity&rdquo; on the map (circular areas) where the quest marker/location lies somewhere within. Locations you&rsquo;ve visited still show up on compass/map, but &ldquo;unvisited&rdquo; locations do not. Since UI modding is possible, I am not sure to what extent we can mod the map like this and whether or not enabling a bunch of active quests will make this too noisy.</p>

<p><strong>Item Sorting</strong></p>

<p><a href="http://www.reddit.com/r/skyrimmods/comments/ma5v2/request_improved_inventory_sorting/">Already suggested</a>. Ability to sort your inventory/containers by weight/price at the least. Always takes me too long to figure out what to give to my pack mule for carrying or dropping.</p>

<p><strong>Chest Categories</strong></p>

<p><a href="http://www.reddit.com/r/skyrimmods/comments/mb2sm/request_chest_sorting/">Already suggested</a>. Ability for chests to have categories ala characters.</p>

<p><strong>Quick Compare</strong></p>

<p>Already suggested. Ability to see if a weapon/apparel is better than your current by viewing in the gameworld (hover) or in a chest (in the details or bottoms status bar).</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/posts/23/mvc-pro-tip-dont-use-the-id-url-parameter-in-your">MVC Pro Tip: Don&#8217;t Use the &#8220;Id&#8221; URL Parameter in Your Routes</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-11-02T14:25:08-05:00" pubdate data-updated="true">Nov 2<span>nd</span>, 2011</time>
        
           | <a href="/blog/posts/23/mvc-pro-tip-dont-use-the-id-url-parameter-in-your#disqus_thread"
             data-disqus-identifier="http://kamranicus.com/blog/posts/23/mvc-pro-tip-dont-use-the-id-url-parameter-in-your">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>By default, MVC will use a route layout like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="n">routes</span><span class="p">.</span><span class="n">MapRoute</span><span class="p">(</span>
</span><span class='line'>  <span class="s">&quot;Default&quot;</span><span class="p">,</span> <span class="c1">// Route name</span>
</span><span class='line'>  <span class="s">&quot;{controller}/{action}/{id}&quot;</span><span class="p">,</span> <span class="c1">// URL with parameters</span>
</span><span class='line'>  <span class="k">new</span> <span class="p">{</span> <span class="n">controller</span> <span class="p">=</span> <span class="s">&quot;Home&quot;</span><span class="p">,</span> <span class="n">action</span> <span class="p">=</span> <span class="s">&quot;Index&quot;</span><span class="p">,</span> <span class="n">id</span> <span class="p">=</span> <span class="n">UrlParameter</span><span class="p">.</span><span class="n">Optional</span> <span class="p">}</span> <span class="c1">// Parameter defaults</span>
</span><span class='line'><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>Besides the fact that you shouldn&rsquo;t use the default route (use named routes!), there&rsquo;s another issue.</p>

<p>Do you have any domain models like this?</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">class</span> <span class="nc">Foo</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">public</span> <span class="kt">int</span> <span class="n">Id</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now, let&rsquo;s say you wanted to add a new Edit method for this model:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">public</span> <span class="n">FooController</span> <span class="p">{</span>
</span><span class='line'><span class="na">    [HttpPost]</span>
</span><span class='line'>    <span class="k">public</span> <span class="n">ActionResult</span> <span class="nf">Edit</span><span class="p">(</span><span class="kt">int</span> <span class="n">id</span><span class="p">,</span> <span class="n">Foo</span> <span class="n">foo</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>There will be a problem here if you expect to be able to change this ID (rare but it happens). MVC will model bind the route&rsquo;s <code>id</code> parameter to your model&rsquo;s ID, possibly breaking your code. This is because MVC does not differentiate your two <code>id</code> and <code>Id</code> parameters, it sees them as one in the same (this has to do with the underlying <code>Request</code> collection).</p>

<h3>Fix it!</h3>

<p>It&rsquo;s simple to fix. Instead of using <code>id</code> as a URL parameter throughout your application, use something else! I typically use <code>identifier</code>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="n">routes</span><span class="p">.</span><span class="n">MapRoute</span><span class="p">(</span>
</span><span class='line'>  <span class="s">&quot;Default&quot;</span><span class="p">,</span> <span class="c1">// Route name</span>
</span><span class='line'>  <span class="s">&quot;{controller}/{action}/{identifier}&quot;</span><span class="p">,</span> <span class="c1">// URL with parameters</span>
</span><span class='line'>  <span class="k">new</span> <span class="p">{</span> <span class="n">controller</span> <span class="p">=</span> <span class="s">&quot;Home&quot;</span><span class="p">,</span> <span class="n">action</span> <span class="p">=</span> <span class="s">&quot;Index&quot;</span><span class="p">,</span> <span class="n">identifier</span> <span class="p">=</span> <span class="n">UrlParameter</span><span class="p">.</span><span class="n">Optional</span> <span class="p">}</span> <span class="c1">// Parameter defaults</span>
</span><span class='line'><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Controller</span>
</span><span class='line'><span class="k">public</span> <span class="n">FooController</span> <span class="p">{</span>
</span><span class='line'><span class="na">    [HttpPost]</span>
</span><span class='line'>    <span class="k">public</span> <span class="n">ActionResult</span> <span class="nf">Edit</span><span class="p">(</span><span class="kt">int</span> <span class="n">identifier</span><span class="p">,</span> <span class="n">Foo</span> <span class="n">foo</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Voila. No more model binding issues!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/posts/22/whats-the-most-efficient-way-to-read-config-settin">What&#8217;s the Most Efficient Way to Read Config Settings in .NET?</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-10-20T20:33:09-05:00" pubdate data-updated="true">Oct 20<span>th</span>, 2011</time>
        
           | <a href="/blog/posts/22/whats-the-most-efficient-way-to-read-config-settin#disqus_thread"
             data-disqus-identifier="http://kamranicus.com/blog/posts/22/whats-the-most-efficient-way-to-read-config-settin">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>In a project I&rsquo;m contributing to, I saw some code like this (simplified but boiling down to):</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">public</span> <span class="k">static</span> <span class="kt">string</span> <span class="n">ConfigValue</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">get</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">System</span><span class="p">.</span><span class="n">Configuration</span><span class="p">.</span><span class="n">ConfigurationManager</span><span class="p">.</span><span class="n">AppSettings</span><span class="p">[</span><span class="s">&quot;ConfigValue&quot;</span><span class="p">];</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Is there anything wrong with this? It&rsquo;s a static read-only property. That seems pretty reasonable!</p>

<h3>Storage matters</h3>

<p>The issue that I saw was that there&rsquo;s no real reason to do this. You could do this just as easily:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">public</span> <span class="k">static</span> <span class="k">readonly</span> <span class="kt">string</span> <span class="n">ConfigValue</span> <span class="p">=</span>
</span><span class='line'>     <span class="n">System</span><span class="p">.</span><span class="n">Configuration</span><span class="p">.</span><span class="n">ConfigurationManager</span><span class="p">.</span><span class="n">AppSettings</span><span class="p">[</span><span class="s">&quot;ConfigValue&quot;</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<p><em>So, who cares? It looks the same to me!</em> As far as I can tell, you should care, even a little bit. Check this out:</p>

<p><img src="/blog/images/34.png" alt="Perf Timer" /></p>

<p>Notice anything? The <code>static readonly</code> field is far and away faster than any other approach (400 <em>nanoseconds</em>). The other three approaches are pretty similar, ranging from 95ms to 104ms. I&rsquo;ll do the math for you:</p>

<blockquote><p><strong>A <code>static readonly</code> field is upwards of 200x faster</strong> than the equivalent property implementation.</p></blockquote>

<p>The reason is simple: <code>get/set</code> are translated into methods by the compiler. A field is simply a field. Any property will incur some penalty for wrapping methods, so a field will always be faster! I use properties all the time but sometimes it might make sense to forgo a property in favor of a field.</p>

<h3>The test case</h3>

<p>Will you ever notice differences this small? I doubt it (the test was 100000 iterations). I did this for a learning experiment and for future reference. <strike>However, reading a config file is I/O at its core. To me, that says you should care about minimizing possible calls to the disk. Under a substantial load test, perhaps this would incur a visible penalty to page load time depending on how many calls you had to your settings wrapper.</strike> (<strong>Update:</strong> One of my colleagues pointed out that app config is probably loaded on start-up, so there shouldn&rsquo;t any disk I/O happening.)</p>

<p><strong>Performance matters</strong> but this is probably so picky that you really don&rsquo;t ever need to worry about it. As my co-worker said to me after reading this:</p>

<blockquote><p>&ldquo;A single call to a suboptimal EF/NHibernate/SQL query is far more damaging than 100,000 calls to these simple properties/fields. If a query took 1 second it would be roughly equivalent to 1,000,000 calls to the most inefficient property implementation. I would say spend your time where you get the biggest bang for your buck.&rdquo;</p></blockquote>

<p>Couldn&rsquo;t have said it better myself! If you&rsquo;re doing perf testing, make changes where it matters. This is only a microscopic change compared to some that would make more of a difference (such as how you handle <code>Regex</code>).</p>

<p>Here&rsquo;s the test case. I am not entirely positive if there&rsquo;s unseen overhead but the other three examples are common things I&rsquo;ve seen or even done in regards to this type of pattern:</p>

<script src="https://gist.github.com/1302236.js?file=PerfTestCaseBackingMethods.cs"></script>


<p>Let me know if I made a mistake in the test case that&rsquo;s skewing results and I&rsquo;ll fix it.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/posts/21/integrated-disqus-comment-system-into-kamranicus">Integrated Disqus Comment System Into Kamranicus</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-10-07T14:41:16-05:00" pubdate data-updated="true">Oct 7<span>th</span>, 2011</time>
        
           | <a href="/blog/posts/21/integrated-disqus-comment-system-into-kamranicus#disqus_thread"
             data-disqus-identifier="http://kamranicus.com/blog/posts/21/integrated-disqus-comment-system-into-kamranicus">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>When I wrote Kamranicus, I wanted a simple blog where I could use Markdown and copy/paste images. I achieved that but I also built a simple comment system.</p>

<p>While fun and a good exercise in using OpenID, I should have thought to check if there is any universal comment system available. There is. It&rsquo;s called <a href="http://disqus.com">Disqus</a>. Unfortunately, I discovered it after I made Kamranicus.</p>

<p>As you can see now, Disqus is now the comment backend for Kamranicus&#8217; posts. Now I can allow anyone to comment using whatever provider they want, moderate comments, have comment threads, trackbacks, and loads of other useful features.</p>

<p>It was easy to integrate. Check it out if you are in the same situation as me.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/posts/20/some-thoughts-on-the-new-mileage-stats-net-sample">Some Thoughts on the New Mileage Stats .NET Sample Application</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-09-20T18:35:42-05:00" pubdate data-updated="true">Sep 20<span>th</span>, 2011</time>
        
           | <a href="/blog/posts/20/some-thoughts-on-the-new-mileage-stats-net-sample#disqus_thread"
             data-disqus-identifier="http://kamranicus.com/blog/posts/20/some-thoughts-on-the-new-mileage-stats-net-sample">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&rsquo;m [still] reading through the docs on the new Mileage Stats application that was just released by Microsoft. It looks pretty cool! A little more real-world than typical sample applications.</p>

<h3>But I have some questions&hellip;</h3>

<p>No application design is perfect but as I read some of this documentation, I am wondering about a couple things. <strong>I haven&rsquo;t finished reading all of the docs yet,</strong> so these are just some random thoughts:</p>

<h4>BackboneJS</h4>

<p>It seems like for a sample MVC application that needs to support progressive enhancement and work in JS/non-JS environments, <a href="http://backbonejs.com/">BackboneJS</a> would be a suitable alternative to the jQuery UI widget + jQuery BBQ implementation they are using.</p>

<p><strong>Update</strong>:</p>

<p>Hah, further down the same Readme page I was looking at, they mentioned BackboneJS or Knockout as alternative considerations:</p>

<blockquote><p>A design the Project Silk team is interested in investigating in the future involves the use of jQuery UI Widgets that can be data bound within an MVVM implementation such as Knockout.js.</p></blockquote>

<p>I wonder why they didn&rsquo;t want to do that for the sample itself? From the reading, it sounds like it was because they wanted to minimize external dependencies. Perhaps it could also be seen as an official endorsement of whatever library they could have chosen (even though they explicitly state for jqPlot that it shouldn&rsquo;t be taken as an &ldquo;official&rdquo; recommendation).</p>

<h4>AmplifyJS</h4>

<p>Client side data manager is a big emphasis in this application. It says in the Readme that:</p>

<blockquote><p>&ldquo;Data is cached in a JavaScript object, rather than using HTML5 local storage or similar APIs, in order to meet the cross-browser requirements of the application.&rdquo;</p></blockquote>

<p>Hmm, well, won&rsquo;t <a href="http://amplifyjs.com">AmplifyJs</a> cover data management needs then? It supports all browsers and <a href="http://amplifyjs.com/api/store/">unifies the storage mechanism APIs</a>. It <a href="http://amplifyjs.com/api/pubsub/">does some pub/sub stuff</a> for you as well. In old browsers, a non-standard way will be used to store data but on modern browsers, localStorage and sessionStorage will be used.</p>

<p>I wonder if the team took a look&mdash;and if they did, what they thought of it. From the surface, it looks like it would be better than rolling your own storage and pub/sub routines.</p>

<h3>That&rsquo;s all for now</h3>

<p>Like I said, I&rsquo;m still reading/learning it. I&rsquo;ll update this as I read more.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/7/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/5/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  	<h1>About Me</h1>

  	<p><img src="http://gravatar.com/avatar/8303c4eb9f9099df39adbc3d8c634746?s=120" alt="My Headshot" title="My ugly mug" /></p>

  	<p>Hi, my name is Kamran. I am a web developer and designer, residing in Minnesota. I&#8217;ve been programming since 2001 and I am familiar with many different languages, both web-based and server-based. I love to tinker around and think of new ways to solve problems.</p>

	<p>If you wanna talk, tweet <strong><a href="http://twitter.com/kamranayub" target="_blank">@kamranayub</a></strong> or send me an email at my <strong>full name</strong> at <strong>gmail.com</strong></p>
</section>
<section>
  	<h1>Apps</h1>

  	<ul>
  		<li><a href="http://centwiseapp.com/">Centwise</a></li>
  		<li><a href="http://wp-bowling.tumblr.com/">Bowling Calculator</a></li>
  		<li><a href="http://keeptrackofmygames.com/">Keep Track of My Games</a></li>  		
  	</ul>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/12/10/just-released-bowling-calculator-app/">Just Released: Bowling Calculator App</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/12/05/miniprofiler-ravendb-pull-request-accepted/">MiniProfiler RavenDB Pull Request Accepted</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/12/04/kamranicus-now-with-100-percent-more-octopress/">Kamranicus: Now With 100% More Octopress</a>
      </li>
    
      <li class="post">
        <a href="/blog/posts/79/just-pushed-blackjack-sample-game">Just Pushed: Blackjack Sample Game</a>
      </li>
    
      <li class="post">
        <a href="/blog/posts/78/tccc15-see-you-again-in-april">TCCC15: See You Again in April!</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/kamranayub">@kamranayub</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'kamranayub',
            count: 5,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/104789622697290911192?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Kamran -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'kamranicus';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>





  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
