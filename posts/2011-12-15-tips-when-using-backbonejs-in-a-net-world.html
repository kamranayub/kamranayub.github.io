<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge" />

  <title>Kamranicus | Kamran Ayub - Tips When Using Backbone.js in a .NET world</title>
  <meta name="description" content="Kamran Ayub" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="author" content="Kamran Ayub">

  <link href="http://feeds.feedburner.com/Kamranicus" rel="alternate" title="Kamranicus (RSS)" type="application/atom+xml">
  <link rel="shortcut icon" href="/favicon.png" type="image/png">
  <link rel="icon" href="/favicon.png" type="image/png">

  <link href="/assets/ui/semantic.min.css" rel="stylesheet" />
  <link href="/assets/css/highlight.css" rel="stylesheet">

  <meta name="application-name" content="Kamranicus | Kamran Ayub" />
  <meta name="msapplication-tooltip" content="Kamranicus | Kamran Ayub" />
  <meta name="msapplication-starturl" content="/" />

  <meta property="og:title" content="Kamranicus | Kamran Ayub - Tips When Using Backbone.js in a .NET world" /> 
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://kamranicus.com/posts/2011-12-15-tips-when-using-backbonejs-in-a-net-world" />
  <meta property="og:site_name" content="Kamranicus" />
  <meta property="twitter:card" content="summary" />
  <meta property="twitter:creator" content="@kamranayub" />

  <!-- TODO: More social graph meta tags -->
  <script type="application/ld+json">
  {
      "@context": "http://schema.org",
      "@type": "WebSite",
      "name": "Kamranicus",
      "url": "https://kamranicus.com/",
      "sameAs": [
        "http://www.twitter.com/kamranayub"
      ]
  }
  </script>


  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
    <script src="/assets/js/html5shiv.js"></script>
    <script src="/assets/js/respond.min.js"></script>
  <![endif]-->
  <script src="/assets/js/picturefill.min.js" async></script>

  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-1203259-13']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  

  


</head>

<body>

  <!-- Navigation -->
  <div class="ui container">
    <nav class="ui huge text site menu">
      
      <a class="header item" href="/">Kamranicus | Kamran Ayub</a>
      
      <div class="ui right item">
              <div class="item">
        <a href="/about">Contact</a>
      </div>
      <div class="item">
        <a href="/events">Events</a>
      </div>
      <div class="item">
        <a href="/guides">Guides</a>
      </div>
      <div class="item">
        <a href="/projects">Projects</a>
      </div>
      <div class="item">
        <a href="/training">Training</a>
      </div>
      <div class="item">
        <a href="/travel">Travel</a>
      </div>

      </div>
    </nav>
  </div>
  <!-- Page Header -->

  <header class="ui vertical masthead segment  " id="intro-header">
    <div class="ui container">

    
<div class="ui basic vertical segment">
    <h1 class="ui  huge header">
      Tips When Using Backbone.js in a .NET world
    </h1>
                
    <div class="ui  sub header">        
Published on Friday, December 16, 2011<br>    </div>
        <div class="ui basic vertical spaced segment">
                    <a role="button" href="/tags/NET" class="ui small compact button">.NET</a>
                    <a role="button" href="/tags/Backbonejs" class="ui small compact button">Backbone.js</a>
        </div>     
</div>
    </div>
  </header>

  <!-- Main Content -->
  <div class="ui stackable grid container">
    <div class="content column">
      

<div class="ui huge basic post content segment">
  <p>I am learning <a href="http://documentcloud.github.com/backbone/">Backbone.js</a> so I can re-write the main GUI for <a href="http://keeptrackofmygames.com">KTOMG</a>. I am still learning and I've run into a couple gotchas that I hope I can clear up for anyone else that dares to tread in these woods. Still, I've been able to rewrite the listing of a user's library in one night using Backbone and all my existing back-end code (the farthest up I edited was my controller). Very impressive for a Backbone n00b!</p>
<h2 id="backbone-is-your-application">Backbone IS your application</h2>
<p>After watching the <a href="http://peepcode.com/products/backbone-iii">PeepCode screencasts</a> (I, II, and III), I have realized something about Backbone.</p>
<blockquote class="blockquote">
<p>Backbone will pretty much replace your MVC views and controller logic.</p>
</blockquote>
<p>This didn't hit me until the last episode and at first, this felt threatening. I am working in ASP.NET MVC and it feels wrong to not utilize it. After thinking about it some more, however, there were a few important points to consider:</p>
<ol>
<li>Backbone doesn't <em>necessarily</em> have to be your whole app. In fact, right now I am only using Backbone for the main &quot;library&quot; interface and I am keeping the rest of the site in plain-old MVC 3.</li>
<li>You still use your controllers and could even use your Razor views as HTML templates.</li>
</ol>
<p>Considering those points, I felt a lot better about using Backbone. Not only will it be a great experience, it'll also make the most important part of my application very responsive and robust, without needing to worry a ton about the plumbing.</p>
<p>Who knows? Maybe KTOMG will be running on Node.js by the end of the month.</p>
<h2 id="tips-when-using-backbone-with-asp.net-mvc">Tips When Using Backbone with ASP.NET MVC</h2>
<p>There were a few gotchas I ran into when using Backbone in my typical .NET environment.</p>
<h3 id="use-attributerouting-like-now">Use AttributeRouting, like, now</h3>
<p><a href="https://github.com/mccalltd/AttributeRouting">AttributeRouting</a> is one of my new favorite packages. It axes the mostly-confusing, mostly-convoluted Global.asax way of handling routes in favor of a more-discoverable (I feel) way of doing routes by decorating actual controller methods:</p>
<pre><code class="language-c#">using AttributeRouting;

[RoutePrefix(&quot;games&quot;)]
public class GamesController : Controller {
  
  //
  // GET: /games/

  [GET(&quot;&quot;)
  public ActionResult Index() {}

  //
  // POST: /games/

  [POST(&quot;&quot;)
  public ActionResult New(Model model) {}

}
</code></pre>
<p>Hopefully you will see why this is useful. Backbone is opinionated in that it assumes you're using a RESTful interface for your API. In normal vanilla MVC, this could turn your Global.asax into a routing nightmare. However, with AttributeRouting, it's easy! Here's an example of a <a href="http://stackoverflow.com/a/6263133/109458">Backbone-compatible REST controller</a>:</p>
<pre><code class="language-c#">using AttributeRouting;

[RoutePrefix(&quot;api/games&quot;)]
public class GamesApiController : Controller {
	
	//
	// GET: /api/games/
	
	[GET(&quot;&quot;)]
	public JsonResult Index() {}

	//
	// POST: /api/games/
	
	[POST(&quot;&quot;)]
	public JsonResult Create() {}
	
	//
	// GET: /api/games/{id}
	
	[GET(&quot;{id}&quot;)]
	public JsonResult Show(int id) {}
	
	//
	// PUT: /api/games/{id}
	
	[PUT(&quot;{id}&quot;)]
	public JsonResult Update(int id) {}
	
	//
	// DELETE: /api/games/{id}
	
	[DELETE(&quot;{id}&quot;)]
	public JsonResult Delete(int id) {}
	
}
</code></pre>
<p>Good fodder for a T4 template. If you have a larger site, consider using an <code>Api</code> MVC Area for cleaner separation.</p>
<h3 id="be-careful-when-serializing-your-objects">Be careful when serializing your objects</h3>
<p>I ran into two gotchas with serializing my objects.</p>
<p>First, if you have an <code>Id</code> property/field, Backbone will not be happy. <strike>It needs to be lowercase id</strike>. You should utilize the <a href="https://github.com/documentcloud/backbone/blob/master/backbone.js#L153https://github.com/documentcloud/backbone/blob/master/backbone.js#L153"><code>idAttribute</code></a> option on your Backbone model to override the property name. It took me forever to figure out why nothing was happening when I deleted a model.</p>
<pre><code class="language-js">class MyModel extends Backbone.Model
  idAttribute: &quot;Id&quot;
</code></pre>
<p>Second, if you are going to serialize EF entities when proxying or lazy-loading is enabled, you need to use a serialization framework like <a href="http://json.codeplex.com/">JSON.NET</a> <strong>or</strong> you need to make flat DTO objects (or view models). I opted for the latter approach first because it was quick, but I am in the process of implementing JSON.NET to do serialization of my entities for me.</p>
<p>For EF serialization, you need to use a custom <code>ContractResolver</code>. I borrowed <a href="http://stackoverflow.com/questions/6991596/serializing-ef4-1-entities-using-json-net">this one</a>. Furthermore, I also needed to set the <code>ReferenceLoopHandling</code> to <code>Ignore</code> on a new <code>JsonSerializerSettings</code> object so it would avoid circular references.</p>
<p>Finally, this is optional but considering the first gotcha, I highly recommend you inherit the EF contract resolver above from <code>CamelCasePropertyNamesContractResolver</code> so your JSON is serialized with camelCase properties.</p>
<h3 id="consider-leveraging-razoraspx-partial-views-for-your-templates">Consider leveraging Razor/ASPX partial views for your templates</h3>
<p>I haven't actually tried this, but I don't see why it wouldn't work. In a Backbone project you'll typically have plenty of templates. Right now I have 3 but I expect it to grow quite a bit in the future. I was planning on moving all these templates to <code>.cshtml</code> files and then using <code>&#64;Html.Partial(&quot;_TemplateName&quot;)</code> to include them in my main layout. I may even create a small extension method to wrap that in a <code>&lt;script&gt;</code> tag. I will update this post if I do.</p>
<p>If you happen to be working on an OSS project, you should be using <a href="http://getcassette.net">Cassette</a> because it can package up your HTML/Knockout templates and <a href="http://getcassette.net/documentation/html-templates">include them all in your page for you</a> <strong>automagically</strong>. If I wasn't using AppHarbor and I was using a dedicated server, I would buy Cassette in a second. I wish they had per-site licenses.</p>
<h3 id="use-those-organization-skills">Use those organization skills</h3>
<p>ASP.NET MVC comes with a friendly and intuitive file layout out-of-the-box:</p>
<pre><code>Project
 |_ Controllers
 |_ Models
 |_ Scripts
 |_ Styles
 |_ Views
</code></pre>
<p>I've shortened mine, plus I've made my scripts directory a bit more Backbone friendly:</p>
<pre><code>Project
 |_ Controllers
 |_ Models
 |_ Public
   |_ Images
   |_ Scripts
     |_ App
       |_ Collections.coffee
       |_ Backbone CoffeeScript files
     |_ Framework (or Vendor)
   |_ scss files...
 |_ Views
</code></pre>
<p>It's up to you how you like to organize, and perhaps you'd even like to separate it further down into modules.</p>
<h3 id="learn-coffeescript-and-sass">Learn CoffeeScript and SASS</h3>
<p>This technically does not have anything to do with .NET or Backbone. However, your life will be <em>easier</em> if you learn CoffeeScript as that makes using Backbone that much more pleasant:</p>
<pre><code>class GameView extends Backbone.View
  className: 'game'
  template: _.template($(&quot;#game-template&quot;).html())

  initialize: (options) -&gt; 
    &#64;model.bind 'change', &#64;render, &#64;

  render: -&gt; 
    $(&#64;el).html &#64;template()
    &#64; # Never forget this line in render() or you'll regret it
</code></pre>
<p>(<em>Disclaimer:</em> This is not real and won't run; it's meant as an illustration of Backbone in CoffeeScript)</p>
<p>It's much nicer to write in Backbone without all those pesky parenthesis and manual <code>bindAll</code> or <code>extend</code> shenanigans. Again, I'd recommend <a href="http://peepcode.com/products/coffeescript">PeepCode's CoffeeScript screencast</a>, that's about all it takes to learn it properly.</p>
<p><img src="http://www.mindscapehq.com/upload/web-workbench/preview.png" class="img-fluid" alt="Mindscape Example" /></p>
<p>If you do decide to take the plunge (it's worth it!), get yourself <a href="http://www.mindscapehq.com/products/web-workbench">Mindscape Web Workbench</a> and you'll be a much happier camper when working with Coffee, SASS, and LESS in Visual Studio.</p>

</div>

<h3 class="ui horizontal divider">
  Don't miss any updates!
</h3>

<div class="ui two column mobile tablet computer reversed divided grid">
  <div class="row">
    <div class="column">
      <p class="ui text tiny"><em>No spam and I usually send a newsletter once a quarter with content you won't see on the blog.</em></p>
    </div>
    <div class="column">
      <div class="ui items" id="mc_embed_signup">
        <form action="https://kamranicus.us18.list-manage.com/subscribe/post?u=45a27b0b6fc6f929b90e35338&amp;id=89bb6697c0" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
          <div class="item" id="mc_embed_signup_scroll">
            <div class="content">
              <div class="ui input">
                <input type="email" value="" name="EMAIL" placeholder="Your Email" class="required email" id="mce-EMAIL">
              </div>
              <div id="mce-responses" class="clear" style="margin-top: 1em;">
                <div class="response" id="mce-error-response" style="display:none"></div>
                <div class="response" id="mce-success-response" style="display:none"></div>
              </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
              <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_45a27b0b6fc6f929b90e35338_89bb6697c0" tabindex="-1" value=""></div>
              <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="ui primary button"></div>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<div class="ui horizontal divider">
  About Kamran
</div>

<div class="ui items">
  <div class="item">
    <div class="ui small circular image">
      <img src="/assets/images/me.jpg" title="Kamran Ayub">
    </div>

    <div class="content">
      <div class="description">
        <p>I&#x27;m a technologist, speaker, and Pluralsight author and I specialize in building full-stack solutions with a focus on modern web technology and cloud native architecture.</p>
        <p><a href="http://bit.ly/KamranOnPluralsight"><img src="/assets/images/pluralsight.png" alt="Kamran's Pluralsight courses" title="Check out my Pluralsight courses!" style="max-width:80%;margin:1em 0;"></a></p>
      </div>
      <div class="extra">
        <a class="ui circular icon button" href="https://twitter.com/kamranayub" title="Twitter">
  <i class="twitter icon"></i>
</a>
<a class="ui circular icon button" href="https://github.com/kamranayub" title="GitHub">
  <i class="github icon"></i>
</a>
<a class="ui circular icon button" href="https://instagram.com/subkamran" title="Instagram">
  <i class="instagram icon"></i>
</a>
<a class="ui circular icon button" href="http://www.youtube.com/c/Kamranicus " title="YouTube">
  <i class="youtube icon"></i>
</a>
<a class="ui circular icon button" href="https://twitch.tv/kamranicus " title="YouTube">
  <i class="twitch icon"></i>
</a>
<a class="ui circular icon button" href="https://www.linkedin.com/in/subkamran" title="LinkedIn">
  <i class="linkedin icon"></i>
</a>
      </div>
    </div>
  </div>
</div>

<div id="disqus_thread"></div>

<script type="text/javascript">
    var disqus_shortname = 'kamranicus';
    var disqus_identifier = '26';
    var disqus_title = 'Tips When Using Backbone.js in a .NET world';
    var disqus_url = 'https://kamranicus.com/posts/2011-12-15-tips-when-using-backbonejs-in-a-net-world';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

      <!-- Disqus -->
<div id="disqus_thread"></div>

<script type="text/javascript">
    var disqus_shortname = 'kamranicus';
    var disqus_identifier = '26';
    var disqus_title = 'Tips When Using Backbone.js in a .NET world';
    var disqus_url = 'https://kamranicus.com/posts/2011-12-15-tips-when-using-backbonejs-in-a-net-world';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>    </div>
  </div>

  <div class="ui divider"></div>
  
  <!-- Footer -->
  <footer>   
    <div class="ui center aligned container">
  <p class="ui grey sub header">Copyright © Kamran Ayub 2020</p>
  
  <div class="ui basic vertical segment">
    <a class="ui circular icon button" href="https://twitter.com/kamranayub" title="Twitter">
  <i class="twitter icon"></i>
</a>
<a class="ui circular icon button" href="https://github.com/kamranayub" title="GitHub">
  <i class="github icon"></i>
</a>
<a class="ui circular icon button" href="https://instagram.com/subkamran" title="Instagram">
  <i class="instagram icon"></i>
</a>
<a class="ui circular icon button" href="http://www.youtube.com/c/Kamranicus " title="YouTube">
  <i class="youtube icon"></i>
</a>
<a class="ui circular icon button" href="https://twitch.tv/kamranicus " title="YouTube">
  <i class="twitch icon"></i>
</a>
<a class="ui circular icon button" href="https://www.linkedin.com/in/subkamran" title="LinkedIn">
  <i class="linkedin icon"></i>
</a>
  </div>

  <p class="ui basic vertical segment">      
    <a href="http://feeds.feedburner.com/Kamranicus" class="ui right labeled icon button">
      Subscribe via RSS or email
      <i class="right rss icon"></i>
    </a>
  </p>  
  <p class="ui tiny basic vertical segment">
    <a href="https://wyam.io">Statically generated by Wyam</a>
  </p>
</div>

  </footer>

  <script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
    crossorigin="anonymous"></script>
  <script src="/assets/ui/semantic.min.js"></script>
  <script src="/assets/js/highlight.pack.js"></script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-6930375300621668",
          enable_page_level_ads: true
     });
</script>

  <script>hljs.initHighlightingOnLoad();</script>
</body>
</html>